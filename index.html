<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bros Adventure Hub</title>
  <style>
    :root { --bg-black:#0d0d0d; --neon-green:#00ff66; --dark-gray:#1a1a1a; }
    body { font-family:'Trebuchet MS', sans-serif; margin:0; background:var(--bg-black); color:var(--neon-green); }
    header { text-align:center; padding:2rem; background:var(--dark-gray); border-bottom:2px solid var(--neon-green); }
    header h1 { margin:0; font-size:2.5rem; color:var(--neon-green); }
    nav { background:var(--bg-black); display:flex; justify-content:center; padding:.5rem; border-bottom:2px solid var(--neon-green); }
    nav ul { list-style:none; display:flex; gap:1rem; margin:0; padding:0; }
    nav a { text-decoration:none; color:var(--neon-green); font-weight:bold; padding:.5rem 1rem; border:1px solid var(--neon-green); border-radius:4px; transition:background .3s, color .3s; }
    nav a:hover { background:var(--neon-green); color:var(--bg-black); }
    section { padding:2rem; max-width:1000px; margin:auto; }
    h2 { border-bottom:2px solid var(--neon-green); padding-bottom:.5rem; margin-bottom:1rem; }

    /* Additions to match the rest */
    .card { background:var(--dark-gray); border:1px solid var(--neon-green); border-radius:6px; padding:1rem; margin-bottom:1rem; }
    .row { display:flex; gap:.5rem; flex-wrap:wrap; }
    input, textarea, button { background:var(--bg-black); color:var(--neon-green); border:1px solid var(--neon-green); border-radius:4px; padding:.5rem; }
    textarea { min-height:100px; }
    button:hover { background:var(--neon-green); color:var(--bg-black); cursor:pointer; }
    .message-board .message { padding:.4rem 0; border-bottom:1px dashed rgba(0,255,102,.35); }
    .calendar-grid { display:grid; grid-template-columns:repeat(7, 1fr); gap:.5rem; }
    .calendar-grid .day { background:var(--dark-gray); border:1px solid var(--neon-green); border-radius:4px; padding:.5rem; min-height:90px; }
    .event { display:block; margin-top:.35rem; font-size:.85rem; }
    .actions { display:flex; gap:.4rem; margin-top:.5rem; }
    .actions button { padding:.35rem .6rem; font-size:.85rem; }
    .news-item a { color:var(--neon-green); text-decoration:none; font-weight:bold; }
    .news-item a:hover { color:#fff; }
  </style>
</head>
<body>
  <header>
    <h1>Bros Adventure Hub</h1>
    <p>Black & Green Bros Style</p>
  </header>

  <nav>
    <ul>
      <li><a href="#messages">What's Up</a></li>
      <li><a href="#stories">Stories</a></li>
      <li><a href="#notes">Notes</a></li>
      <li><a href="#calendar">Calendar</a></li>
      <li><a href="#news">Latest News</a></li>
    </ul>
  </nav>

  <!-- Messaging -->
  <section id="messages">
    <h2>What's Up</h2>
    <div class="card message-board" id="messageBoard"></div>
    <form id="messageForm" class="row">
      <input type="text" id="messageInput" placeholder="Type your message..." required />
      <button type="submit">Send</button>
    </form>
  </section>

  <!-- Stories -->
  <section id="stories">
    <h2>Stories</h2>
    <div id="storyBoard"></div>
    <form id="storyForm" class="row">
      <input type="text" id="storyTitle" placeholder="Story title" required />
      <textarea id="storyContent" placeholder="Write your story..." required></textarea>
      <button type="submit">Post Story</button>
    </form>
    <p class="card" style="font-size:.9rem;opacity:.85;">Cooldown: 60 seconds between posts. You can edit or delete your story.</p>
  </section>

  <!-- Notes -->
  <section id="notes">
    <h2>Notes</h2>
    <ul class="card" id="notesList" style="list-style:none; padding-left:1rem;"></ul>
    <form id="notesForm" class="row">
      <input type="text" id="noteInput" placeholder="Add a new note..." required />
      <button type="submit">Add Note</button>
    </form>
  </section>

  <!-- Calendar -->
  <section id="calendar">
    <h2>Event Calendar (31 Days)</h2>
    <div class="calendar-grid" id="calendarGrid"></div>
    <form id="calendarForm" class="row">
      <input type="number" id="eventDay" placeholder="Day (1-31)" min="1" max="31" required />
      <input type="text" id="eventName" placeholder="Event name" required />
      <button type="submit">Add Event</button>
    </form>
  </section>

  <!-- Latest News -->
  <section id="news">
    <h2>Latest News</h2>
    <div class="card" id="newsBoard"></div>
  </section>

  <!-- Firebase (compat for simplicity) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script>
    // Replace with your real Firebase config (from Project Settings â†’ Your apps â†’ Web)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const $ = id => document.getElementById(id);

    // --- Messaging (shared) ---
    db.collection("messages").orderBy("ts", "asc").onSnapshot(snap => {
      $("messageBoard").innerHTML = "";
      snap.forEach(doc => {
        const m = doc.data();
        const div = document.createElement("div");
        div.className = "message";
        div.textContent = m.text;
        $("messageBoard").appendChild(div);
      });
    });

    $("messageForm").addEventListener("submit", e => {
      e.preventDefault();
      const val = $("messageInput").value.trim();
      if (!val) return;
      db.collection("messages").add({ text: "You: " + val, ts: Date.now() })
        .then(() => { $("messageForm").reset(); });
    });

    // --- Stories (shared) with cooldown + edit/delete ---
    const COOLDOWN_MS = 60000;
    let lastStoryTime = 0;

    db.collection("stories").orderBy("ts", "asc").onSnapshot(snap => {
      $("storyBoard").innerHTML = "";
      snap.forEach(doc => {
        const s = doc.data();
        const wrap = document.createElement("div");
        wrap.className = "card";
        wrap.innerHTML = `
          <h3>${s.title}</h3>
          <p>${s.content}</p>
          <div class="actions">
            <button class="editBtn">Edit</button>
            <button class="deleteBtn">Delete</button>
          </div>
        `;
        wrap.querySelector(".editBtn").addEventListener("click", () => {
          const updated = prompt("Edit your story:", s.content);
          if (updated && updated.trim() !== "") {
            db.collection("stories").doc(doc.id).update({ content: updated.trim() });
          }
        });
        wrap.querySelector(".deleteBtn").addEventListener("click", () => {
          db.collection("stories").doc(doc.id).delete();
        });
        $("storyBoard").appendChild(wrap);
      });
    });

    $("storyForm").addEventListener("submit", e => {
      e.preventDefault();
      const now = Date.now();
      if (now - lastStoryTime < COOLDOWN_MS) {
        const wait = Math.ceil((COOLDOWN_MS - (now - lastStoryTime)) / 1000);
        alert("Please wait " + wait + "s before posting another story.");
        return;
      }
      const title = $("storyTitle").value.trim();
      const content = $("storyContent").value.trim();
      if (!title || !content) return;
      db.collection("stories").add({ title, content, ts: now })
        .then(() => { lastStoryTime = now; $("storyForm").reset(); });
    });

    // --- Notes (shared) ---
    db.collection("notes").orderBy("ts", "asc").onSnapshot(snap => {
      $("notesList").innerHTML = "";
      snap.forEach(doc => {
        const n = doc.data();
        const li = document.createElement("li");
        li.className = "card";
        li.textContent = n.text;
        $("notesList").appendChild(li);
      });
    });

    $("notesForm").addEventListener("submit", e => {
      e.preventDefault();
      const val = $("noteInput").value.trim();
      if (!val) return;
      db.collection("notes").add({ text: val, ts: Date.now() })
        .then(() => { $("notesForm").reset(); });
    });

    // --- Calendar (shared, 31 days) ---
    // Build the grid once
    for (let day = 1; day <= 31; day++) {
      const cell = document.createElement("div");
      cell.className = "day";
      cell.dataset.day = String(day);
      cell.innerHTML = `<strong>${day}</strong>`;
      $("calendarGrid").appendChild(cell);
    }

    // Live render events
    db.collection("events").orderBy("ts", "asc").onSnapshot(snap => {
      // Clear existing events
      $("calendarGrid").querySelectorAll(".event").forEach(el => el.remove());
      snap.forEach(doc => {
        const ev = doc.data();
        const cell = $("calendarGrid").querySelector(`[data-day="${ev.day}"]`);
        if (cell) {
          const span = document.createElement("span");
          span.className = "event";
          span.textContent = ev.name;
          cell.appendChild(span);
        }
      });
    });

    $("calendarForm").addEventListener("submit", e => {
      e.preventDefault();
      const d = parseInt($("eventDay").value, 10);
      const name = $("eventName").value.trim();
      if (isNaN(d) || d < 1 || d > 31 || !name) return;
      db.collection("events").add({ day: d, name, ts: Date.now() })
        .then(() => { $("calendarForm").reset(); });
    });

    // --- Latest News (static + one fake) ---
    const headlines = [
      { title: "Global markets rebound after holiday slump", url: "https://www.bbc.com/news/business" },
      { title: "Tech companies unveil new AI tools in 2026", url: "https://www.cnn.com/technology" },
      { title: "Lebanon hosts major cultural festival this week", url: "https://www.aljazeera.com/culture" },
      { title: "ðŸš€ Bros Adventure launches secret spaceship to the moon (FAKE)", url: "#" }
    ];
    const newsBoard = $("newsBoard");
    headlines.forEach(item => {
      const div = document.createElement("div");
      div.className = "card news-item";
      div.innerHTML = `<a href="${item.url}" target="_blank">${item.title}</a>`;
      newsBoard.appendChild(div);
    });
  </script>
</body>
</html>
